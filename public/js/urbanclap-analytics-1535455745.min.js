!function(e,t){var i=e.urbanclap=e.urbanclap||{},s=e.uca,n={version:"2.4.0",config:{eventApi:{url:"https://event-api.urbanclap.com/newevent",headers:{"Content-Type":"application/json; charset=utf-8","x-api-token":"oa4hulm06qctaaligr1cq3ohhmo33c5j"},requestMethod:"POST"},log:!1,disabled:!1,dupeDiff:300,attributionValidDays:28,cities:["ahmedabad","bangalore","chennai","delhi-ncr","hyderabad","kolkata","mumbai","pune"]},store:{session:{},previous:{}},uuid:function(){var e=this.cookie.get("_uca_uuid");if(e)return e;var t,i=+new Date,s=Math.floor(999999*Math.random()+9999).toString(16);return"ucucucu".substr(0,8-s.length)+s+"-yxxxxxxxxx-yxxx-yxxx-yxxx-xxxxxxxxxx".replace(/[xy]/g,function(e){return t=((i=Math.floor(i/16))+16*Math.random())%16|0,("x"==e?t:3&t|8).toString(16)})+"-"+ +new Date},cookie:{get:function(e){for(var i=e+"=",s=t.cookie.split(";"),n=0;n<s.length;n++){for(var r=s[n];" "==r.charAt(0);)r=r.substring(1);if(0==r.indexOf(i))return r.substring(i.length,r.length)}return null},set:function(e,i,s){var n=new Date;return n.setTime(n.getTime()+24*(s||36500)*60*60*1e3),t.cookie=e+"="+i+"; expires="+n.toUTCString()+"; path=/",i},del:function(e){var i=new Date;return i.setTime(i.getTime()-864e5),t.cookie=e+"=0; expires="+i.toUTCString()+"; path=/",!0}},session:{start:function(e,t){return t&&n.cookie.get("_uca_session_id")?n.store.session={id:n.cookie.get("_uca_session_id"),startTs:n.cookie.get("_uca_session_start_ts"),endTs:n.cookie.get("_uca_session_end_ts")}:n.store.session={id:n.cookie.set("_uca_session_id",e||n.uuid(),1/24),startTs:n.cookie.set("_uca_session_start_ts",n.getTime(),1/24),endTs:n.cookie.set("_uca_session_end_ts",n.getTime()+36e5,1/24)}},end:function(){return n.session.start(),!0},get:function(){return n.store.session},getPathname:function(){return e.location.pathname}},getQueryParam:function(t){t=t.replace(/[\[\]]/g,"\\$&");var i=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)").exec(e.location.href);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null},browserInfo:{name:function(){var e,t=navigator.userAgent,i=t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(i[1])?"IE "+((e=/\brv[ :]+(\d+)/g.exec(t)||[])[1]||""):"Chrome"===i[1]&&null!=(e=t.match(/\b(OPR|Edge)\/(\d+)/))?e.slice(1).join(" ").replace("OPR","Opera"):(i=i[2]?[i[1],i[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(e=t.match(/version\/(\d+)/i))&&i.splice(1,1,e[1]),i)},type:function(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?"mobile-web":"desktop-web"}},serverSync:function(e){this.fireXhr("https://event-api.urbanclap.com/getconfig?ts="+ +new Date,{},"GET",{},function(t){if(200===t.status){var i=JSON.parse(t.response);n.store.serverSid=i.uuid,n.store.serverTs=i.server_time,n.store.serverTsDiff=+new Date-i.server_time,e()}else n.store.failedAttempts?n.store.failedAttempts++:n.store.failedAttempts=1,n.store.failedAttempts<3&&n.serverSync(e)})},getTime:function(){return+new Date-this.store.serverTsDiff},init:function(){return i.analytics?(this.log("Urbanclap Analytics already loaded."),!1):("object"==typeof s.config&&this.extend(this.config,s.config),this.store.uuid=this.cookie.get("_uca_uuid")||this.cookie.set("_uca_new_user","true",1)&&this.cookie.set("_uca_uuid",this.uuid()),this.session.start(this.store.serverSid,!0),this.defaultData={uuid:this.store.uuid,sessionId:this.store.session.id,version:this.version,url:e.location.href||null,referrer:t.referrer||null,referrerDomain:t.referrer?(n=t.createElement("a"),n.href=t.referrer,n.hostname.replace(/^www\./i,"")):null,userAgent:e.navigator?e.navigator.userAgent:null},"object"==typeof s.defaultData&&this.extend(this.defaultData,s.defaultData),this.store.queuedEvents=s.queue,this.utmAttribution(),this.fireSession(),{track:this.track.bind(this),startSession:this.session.start.bind(this),endSession:this.session.end.bind(this)});var n},fireQueuedEvents:function(){if("object"==typeof this.store.queuedEvents&&this.store.queuedEvents instanceof Array)for(var e=0,t=this.store.queuedEvents,i=t[e];e<t.length;i=t[++e])i.status||(this[i.name].apply(this,i.arguments),i.status=1)},eventData:function(){return{event_timestamp:this.getTime().toString(),client_timestamp:(+new Date).toString(),schema_type:"event",session:{session_id:this.session.get().id,start_timestamp:this.session.get().startTs.toString()},user:{user_type:this.config.userType||"",user_id:this.cookie.get("_uc_user_id")||""},context:{customer_id:this.cookie.get("_uc_user_id")||"",category_key:this.cookie.get("categoryKey")||"",city_key:this.cookie.get("currentCity")||""}}},isDuplicate:function(e){var t=this.store.previous.event;return!!(t&&t.event.name===e.event.name&&t.event.action===e.event.action&&t.event.page===e.event.page&&+new Date-this.store.previous.ts<=this.config.dupeDiff)&&(this.config.log&&this.log("Duplicate event ignored - ",e.event.name,e),!0)},track:function(e){return this.isDuplicate(e)?(this.store.previous={event:e,ts:+new Date},!1):(this.store.previous={event:e,ts:+new Date},this.config.log&&this.log(e.event.name,e),e&&"object"==typeof e?!this.config.disabled&&(this.send(e),!0):(this.log("Invalid event."),!1))},send:function(e){e=this.extend(this.eventData(),e),this.fireXhr(this.config.eventApi.url,[e],this.config.eventApi.requestMethod,this.config.eventApi.headers)},getUtmSource:function(){return t.referrer?((e=t.createElement("a")).href=t.referrer,e.hostname.replace(/^www\./i,"")):"direct";var e},getUtmMedium:function(){var e,i=t.referrer?((e=t.createElement("a")).href=t.referrer,e.hostname.replace(/^www\./i,"")):null;return i?i.match(new RegExp("(google|yahoo|bing|baidu|aol|ask|excite|duckduckgo).([^/?]*)","i"))?"organic":i.match(new RegExp("(tumblr|flickr|pinterest|linkedin|youtube|twitter|facebook|instagram).([^/?]*)","i"))?"social":"":""},getUtmLanding:function(){var t="other",i=e.location.pathname||"";return"/"===i||-1!==("/"+this.config.cities.join("/")).indexOf(i)?t="homepage":-1!==i.indexOf("/request/")?t="request":-1!==i.indexOf("/pro/")?t="pro":-1!==i.indexOf("/s/")?t="sem":i.match(new RegExp("["+this.config.cities.join("|")+"-]+","i"))&&(t="listing"),t},getUtm:function(e){switch(e){case"source":var t=this.getUtmSource();return this.getQueryParam("utm_source")||("direct"===t||"urbanclap.com"===t?this.cookie.get("_uca_utm_source")||"direct":t);case"medium":return this.getQueryParam("utm_medium")||this.getUtmMedium()||this.cookie.get("_uca_utm_medium")||"";case"campaign":return this.getQueryParam("utm_campaign")||this.cookie.get("_uca_utm_campaign")||"";case"term":return this.getQueryParam("utm_term")||this.cookie.get("_uca_utm_term")||"";case"content":return this.getQueryParam("utm_content")||this.cookie.get("_uca_utm_content")||"";case"landing":return this.cookie.get("_uca_utm_landing")||this.getUtmLanding();case"sub_id":return this.getQueryParam("sub_id")||this.cookie.get("_uca_sub_id")||"";default:return""}},utmAttribution:function(){this.cookie.set("_uca_utm_source",this.getUtm("source"),this.config.attributionValidDays),this.cookie.set("_uca_utm_medium",this.getUtm("medium"),this.config.attributionValidDays),this.cookie.set("_uca_utm_campaign",this.getUtm("campaign"),this.config.attributionValidDays),this.cookie.set("_uca_utm_term",this.getUtm("term"),this.config.attributionValidDays),this.cookie.set("_uca_utm_content",this.getUtm("content"),this.config.attributionValidDays),this.cookie.set("_uca_utm_landing",this.getUtm("landing"),this.config.attributionValidDays),this.cookie.set("_uca_sub_id",this.getUtm("sub_id"),1/24)},fireSession:function(){var e=[{event_timestamp:this.getTime().toString(),client_timestamp:(+new Date).toString(),schema_type:"session",session:{session_id:this.session.get().id,start_timestamp:this.session.get().startTs.toString(),landing_page:this.session.getPathname(),user_landing:this.getUtm("landing")},user:{user_type:this.config.userType||"",user_id:this.cookie.get("_uc_user_id")||""},client:{client_type:this.browserInfo.type(),device_id:this.store.uuid,device_os:this.defaultData.userAgent,version:this.defaultData.appVersion+"-"+this.version},install_source:{utm_source:this.cookie.get("_uca_utm_source")||"",utm_medium:this.cookie.get("_uca_utm_medium")||"",utm_campaign:this.cookie.get("_uca_utm_campaign")||"",utm_content:this.cookie.get("_uca_utm_content")||"",utm_text:this.getQueryParam("utm_text")||"",gclid:this.getQueryParam("gclid"),af_pid:this.cookie.get("_uca_sub_id")||this.getQueryParam("af_pid")||"",af_campaign:this.cookie.get("_uc_wt_version")||"A",af_install_time:"",af_click_time:""}}];return this.config.log&&this.log("session",e[0]),!this.config.disabled&&(this.fireXhr(this.config.eventApi.url,e,this.config.eventApi.requestMethod,this.config.eventApi.headers),!0)},fireXhr:function(t,i,s,n,r){try{var o=e.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");r&&(o.onreadystatechange=function(){4===o.readyState&&r(o)}),o.open(s,t,!0);for(var a in n)o.setRequestHeader(a,n[a]);o.send(JSON.stringify(i))}catch(e){this.log(e)}},extend:function(){for(var e=1;e<arguments.length;e++)for(var t in arguments[e])arguments[e].hasOwnProperty(t)&&(arguments[0][t]=arguments[e][t]);return arguments[0]},log:function(){e.console&&e.console.log.apply(e.console,[].slice.call(arguments))}};n.serverSync(function(){e.uca=i.analytics=this.init(),i.analytics&&this.fireQueuedEvents()}.bind(n))}(window,document);